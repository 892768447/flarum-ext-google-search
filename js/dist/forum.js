module.exports=function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=15)}([function(e,t){e.exports=flarum.core.compat.app},function(e,t){e.exports=flarum.core.compat["components/IndexPage"]},function(e,t){e.exports=flarum.core.compat.extend},function(e,t){e.exports=flarum.core.compat["components/LinkButton"]},function(e,t){e.exports=flarum.core.compat["components/Button"]},function(e,t){e.exports=flarum.core.compat.Component},function(e,t){e.exports=flarum.core.compat["helpers/listItems"]},function(e,t){e.exports=flarum.core.compat["components/LogInModal"]},function(e,t){e.exports=flarum.core.compat["components/DiscussionsSearchSource"]},function(e,t){e.exports=flarum.core.compat["components/Page"]},function(e,t){e.exports=flarum.core.compat["utils/ItemList"]},function(e,t){e.exports=flarum.core.compat["components/Alert"]},function(e,t){e.exports=flarum.core.compat["components/SelectDropdown"]},function(e,t){e.exports=flarum.core.compat["components/LoadingIndicator"]},function(e,t){e.exports=flarum.core.compat["components/Placeholder"]},function(e,t,o){"use strict";o.r(t);var n=o(2),r=o(0),a=o.n(r),s=o(8),i=o.n(s),c=o(3),l=o.n(c),u=o(1),p=o.n(u);function h(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var f=o(9),g=o.n(f),d=o(10),v=o.n(d),y=o(6),x=o.n(y),b=o(11),N=o.n(b),_=o(7),w=o.n(_),I=o(4),L=o.n(I),P=o(12),S=o.n(P),O=o(5),D=o.n(O),j=o(13),R=o.n(j),T=o(14),M=o.n(T),k=function(e){function t(){return e.apply(this,arguments)||this}return h(t,e),t.prototype.view=function(){var e=this.props.info;return m("div",{className:"DiscussionListItem"},m("a",{href:e.url,className:"DiscussionListItem-main",target:"_blank"},m("h3",{className:"DiscussionListItem-title"},e.title),m("ul",{className:"DiscussionListItem-info"},m("li",{className:"item-excerpt"},m("span",null,e.content)))))},t}(D.a),A=function(e){function t(){return e.apply(this,arguments)||this}h(t,e);var o=t.prototype;return o.init=function(){this.loading=!0,this.moreResults=!1,this.googleresults=[],this.refresh()},o.view=function(){var e,t=this.props.params;if(this.loading?e=R.a.component():this.moreResults&&(e=L.a.component({children:a.a.translator.trans("core.forum.discussion_list.load_more_button"),className:"Button",onclick:this.loadMore.bind(this)})),0===this.googleresults.length&&!this.loading){var o=a.a.translator.trans("irony-google-search.forum.page.empty_text");return m("div",{className:"DiscussionList"},M.a.component({text:o}))}return m("div",{className:"DiscussionList"+(this.props.params.q?" DiscussionList--searchResults":"")},m("ul",{className:"DiscussionList-discussions"},this.googleresults.map((function(e){return m("li",null,k.component({info:e,params:t}))}))),m("div",{className:"DiscussionList-loadMore"},e))},o.requestParams=function(){return this.props.params},o.refresh=function(e){var t=this;return void 0===e&&(e=!0),e&&(this.loading=!0,this.googleresults=[]),this.loadResults().then((function(e){t.googleresults=[],t.parseResults(e)}),(function(){t.loading=!1,m.redraw()}))},o.loadResults=function(e){var t=a.a.preloadedApiDocument();return t?m.deferred().resolve(t).promise:a.a.request({method:"GET",url:a.a.forum.attribute("apiUrl")+"/google/search",data:this.requestParams()}).then((function(e){return e}))},o.loadMore=function(){this.loading=!0,this.loadResults(this.googleresults.length).then(this.parseResults.bind(this))},o.parseResults=function(e){return[].push.apply(this.googleresults,e),this.loading=!1,this.moreResults=!1,m.lazyRedraw(),e},o.removeList=function(e){var t=this.googleresults.indexOf(e);-1!==t&&this.googleresults.splice(t,1)},o.addList=function(e){this.googleresults.unshift(e)},t}(D.a),C=function(e){function t(){return e.apply(this,arguments)||this}h(t,e);var o=t.prototype;return o.init=function(){e.prototype.init.call(this);var o=this.params();if(this.bodyClass="App--index",a.a.previous instanceof t&&(a.a.cache.googleSearchList=null),a.a.cache.googleSearchList&&Object.keys(o).some((function(e){if(a.a.cache.googleSearchList.props.params[e]!==o[e])return a.a.cache.googleSearchList=null,!0})),a.a.cache.googleSearchList||(a.a.cache.googleSearchList=new A({params:o})),!a.a.session.user)return this.alertNotice(),a.a.modal.show(new w.a),!0},o.onunload=function(){a.a.cache.scrollTop=$(window).scrollTop()},o.view=function(){return m("div",{className:"IndexPage"},p.a.prototype.hero(),m("div",{className:"container"},m("div",{className:"sideNavContainer"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,x()(this.sidebarItems().toArray()))),m("div",{className:"IndexPage-results sideNavOffset"},m("div",{className:"IndexPage-toolbar"},m("ul",{className:"IndexPage-toolbar-view"}),m("ul",{className:"IndexPage-toolbar-action"},x()(this.actionItems().toArray()))),a.a.cache.googleSearchList.render()))))},o.config=function(t,o){if(e.prototype.config.apply(this,arguments),!t){Object(n.extend)(o,"onunload",(function(){return $("#app").css("min-height","")})),a.a.setTitle(""),a.a.setTitleCount(0);var r=a.a.cache.heroHeight,s=a.a.cache.heroHeight=this.$(".Hero").outerHeight()||0,i=a.a.cache.scrollTop;$("#app").css("min-height",$(window).height()+s);var c=function(){return $(window).scrollTop(i-r+s)};c(),setTimeout(c,1)}},o.alertNotice=function(){var e;a.a.alerts.show(e=new N.a({type:"error",children:a.a.translator.trans("irony-google-search.forum.page.notice_text")})),setTimeout((function(){a.a.alerts.dismiss(e)}),3e3)},o.sidebarItems=function(){var e=p.a.prototype.sidebarItems();return e.replace("nav",S.a.component({children:this.navItems(this).toArray(),buttonClassName:"Button",className:"App-titleControl"})),e},o.navItems=function(){var e=p.a.prototype.navItems(),t=this.stickyParams();return e.add("irony-google-search",l.a.component({href:a.a.route("irony_google_search",t),children:a.a.translator.trans("irony-google-search.forum.page.nav"),icon:"fab fa-google"}),85),e},o.actionItems=function(){var e=this,t=new v.a;return t.add("refresh",L.a.component({title:a.a.translator.trans("core.forum.index.refresh_tooltip"),icon:"fas fa-sync",className:"Button Button--icon",onclick:function(){a.a.session.user?a.a.cache.googleSearchList.refresh():(e.alertNotice(),a.a.modal.show(new w.a))}})),t},o.searching=function(){return this.params()},o.clearSearch=function(){m.route(a.a.route(this.props.routeName,{}))},o.stickyParams=function(){return m.route.param()},o.params=function(){return m.route.param()},t}(g.a);a.a.initializers.add("irony-google-search",(function(e){e.routes.irony_google_search={path:"/google",component:C.component()},Object(n.extend)(i.a.prototype,"view",(function(t,o){t&&(o=o.toLowerCase(),t.splice(100,0,m("li",{className:"Dropdown-header"},e.translator.trans("irony-google-search.forum.search.search_heading")),m("li",null,l.a.component({icon:"fas fa-search",children:e.translator.trans("irony-google-search.forum.search.all_search_button",{query:o}),href:e.route("irony_google_search",{q:o})}))))})),Object(n.extend)(p.a.prototype,"navItems",(function(t){t.add("irony-google-search",l.a.component({href:e.route("irony_google_search"),children:e.translator.trans("irony-google-search.forum.page.nav"),icon:"fab fa-google"}),85)}))})),o.d(t,"GoogleSearchPage",(function(){return C}))}]);
//# sourceMappingURL=forum.js.map