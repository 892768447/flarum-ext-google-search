{"version":3,"sources":["webpack://@irony/google-search/webpack/bootstrap","webpack://@irony/google-search/external \"flarum.core.compat['app']\"","webpack://@irony/google-search/external \"flarum.core.compat['components/IndexPage']\"","webpack://@irony/google-search/external \"flarum.core.compat['extend']\"","webpack://@irony/google-search/external \"flarum.core.compat['components/LinkButton']\"","webpack://@irony/google-search/external \"flarum.core.compat['components/Button']\"","webpack://@irony/google-search/external \"flarum.core.compat['Component']\"","webpack://@irony/google-search/external \"flarum.core.compat['helpers/listItems']\"","webpack://@irony/google-search/external \"flarum.core.compat['components/DiscussionsSearchSource']\"","webpack://@irony/google-search/external \"flarum.core.compat['components/Page']\"","webpack://@irony/google-search/external \"flarum.core.compat['utils/ItemList']\"","webpack://@irony/google-search/external \"flarum.core.compat['components/Alert']\"","webpack://@irony/google-search/external \"flarum.core.compat['components/SelectDropdown']\"","webpack://@irony/google-search/external \"flarum.core.compat['components/LoadingIndicator']\"","webpack://@irony/google-search/external \"flarum.core.compat['components/Placeholder']\"","webpack://@irony/google-search/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@irony/google-search/./src/forum/components/GoogleSearchListItem.js","webpack://@irony/google-search/./src/forum/components/GoogleSearchList.js","webpack://@irony/google-search/./src/forum/components/GoogleSearchPage.js","webpack://@irony/google-search/./src/forum/index.js","webpack://@irony/google-search/./forum.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","_inheritsLoose","subClass","superClass","constructor","__proto__","GoogleSearchListItem","view","info","this","props","className","href","url","target","title","content","Component","GoogleSearchList","init","loading","moreResults","googleresults","refresh","params","LoadingIndicator","component","Button","children","app","translator","trans","onclick","loadMore","length","text","Placeholder","q","map","requestParams","clear","loadResults","then","results","parseResults","redraw","offset","preloadedLists","preloadedApiDocument","deferred","resolve","promise","request","method","forum","attribute","data","push","apply","lazyRedraw","removeList","list","index","indexOf","splice","addList","unshift","GoogleSearchPage","bodyClass","previous","cache","googleSearchList","keys","some","session","user","alertNotice","onunload","scrollTop","$","window","IndexPage","hero","listItems","sidebarItems","toArray","actionItems","render","config","isInitialized","context","arguments","extend","css","setTitle","setTitleCount","oldHeroHeight","heroHeight","outerHeight","height","scroll","setTimeout","alert","alerts","show","Alert","type","dismiss","items","replace","SelectDropdown","navItems","buttonClassName","stickyParams","add","LinkButton","route","icon","ItemList","searching","clearSearch","routeName","param","Page","initializers","routes","irony_google_search","path","DiscussionsSearchSource","query","toLowerCase"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/IndexPage'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['components/LinkButton'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['helpers/listItems'];","module.exports = flarum.core.compat['components/DiscussionsSearchSource'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['utils/ItemList'];","module.exports = flarum.core.compat['components/Alert'];","module.exports = flarum.core.compat['components/SelectDropdown'];","module.exports = flarum.core.compat['components/LoadingIndicator'];","module.exports = flarum.core.compat['components/Placeholder'];","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import Component from \"flarum/Component\";\r\n\r\nexport default class GoogleSearchListItem extends Component {\r\n  view() {\r\n    const info = this.props.info;\r\n    return (\r\n      <div className=\"DiscussionListItem\">\r\n        <a href={info.url} className=\"DiscussionListItem-main\" target=\"_blank\">\r\n          <h3 className=\"DiscussionListItem-title\">{info.title}</h3>\r\n          <ul className=\"DiscussionListItem-info\">\r\n            <li className=\"item-excerpt\">\r\n              <span>{info.content}</span>\r\n            </li>\r\n          </ul>\r\n        </a>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import app from \"flarum/app\";\r\nimport Component from \"flarum/Component\";\r\nimport Button from \"flarum/components/Button\";\r\nimport LoadingIndicator from \"flarum/components/LoadingIndicator\";\r\nimport Placeholder from \"flarum/components/Placeholder\";\r\nimport GoogleSearchListItem from \"./GoogleSearchListItem\";\r\n\r\n/**\r\n * The `GoogleSearchList` component displays a list of search result.\r\n *\r\n * ### Props\r\n *\r\n * - `params` A map of parameters used to construct a refined parameter object\r\n *   to send along in the API request to get google search results.\r\n */\r\nexport default class GoogleSearchList extends Component {\r\n  init() {\r\n    /**\r\n     * Whether or not google search results are loading.\r\n     *\r\n     * @type {Boolean}\r\n     */\r\n    this.loading = true;\r\n\r\n    /**\r\n     * Whether or not there are more results that can be loaded.\r\n     *\r\n     * @type {Boolean}\r\n     */\r\n    this.moreResults = false;\r\n\r\n    /**\r\n     * the google search list.\r\n     *\r\n     * @type {Array}\r\n     */\r\n    this.googleresults = [];\r\n\r\n    this.refresh();\r\n  }\r\n\r\n  view() {\r\n    const params = this.props.params;\r\n    let loading;\r\n\r\n    if (this.loading) {\r\n      loading = LoadingIndicator.component();\r\n    } else if (this.moreResults) {\r\n      loading = Button.component({\r\n        children: app.translator.trans(\r\n          \"core.forum.discussion_list.load_more_button\"\r\n        ),\r\n        className: \"Button\",\r\n        onclick: this.loadMore.bind(this)\r\n      });\r\n    }\r\n\r\n    if (this.googleresults.length === 0 && !this.loading) {\r\n      const text = app.translator.trans(\r\n        \"irony-google-search.forum.page.empty_text\"\r\n      );\r\n      return (\r\n        <div className=\"DiscussionList\">{Placeholder.component({ text })}</div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div\r\n        className={\r\n          \"DiscussionList\" +\r\n          (this.props.params.q ? \" DiscussionList--searchResults\" : \"\")\r\n        }\r\n      >\r\n        <ul className=\"DiscussionList-discussions\">\r\n          {this.googleresults.map(info => {\r\n            return <li>{GoogleSearchListItem.component({ info, params })}</li>;\r\n          })}\r\n        </ul>\r\n        <div className=\"DiscussionList-loadMore\">{loading}</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get the parameters that should be passed in the API request to get\r\n   * google search results.\r\n   *\r\n   * @return {Object}\r\n   * @api\r\n   */\r\n  requestParams() {\r\n    return this.props.params;\r\n  }\r\n\r\n  /**\r\n   * Clear and reload the google search list.\r\n   *\r\n   * @public\r\n   */\r\n  refresh(clear = true) {\r\n    if (clear) {\r\n      this.loading = true;\r\n      this.googleresults = [];\r\n    }\r\n\r\n    return this.loadResults().then(\r\n      results => {\r\n        this.googleresults = [];\r\n        this.parseResults(results);\r\n      },\r\n      () => {\r\n        this.loading = false;\r\n        m.redraw();\r\n      }\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Load a new page of google search results.\r\n   * 请求api获取数据\r\n   *\r\n   * @param {Integer} offset The index to start the page at.\r\n   * @return {Promise}\r\n   */\r\n  loadResults(offset) {\r\n    const preloadedLists = app.preloadedApiDocument();\r\n\r\n    if (preloadedLists) {\r\n      return m.deferred().resolve(preloadedLists).promise;\r\n    }\r\n\r\n    return app\r\n      .request({\r\n        method: \"GET\",\r\n        url: app.forum.attribute(\"apiUrl\") + \"/google/search\",\r\n        data: this.requestParams()\r\n      })\r\n      .then(function(data) {\r\n        return data;\r\n      });\r\n\r\n    //return app.store.find(\"google/search\", this.requestParams());\r\n  }\r\n\r\n  /**\r\n   * Load the next page of google search results.\r\n   *\r\n   * @public\r\n   */\r\n  loadMore() {\r\n    this.loading = true;\r\n\r\n    this.loadResults(this.googleresults.length).then(\r\n      this.parseResults.bind(this)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Parse results and append them to the google search list.\r\n   *\r\n   * @param {Array} results\r\n   * @return {Array}\r\n   */\r\n  parseResults(results) {\r\n    [].push.apply(this.googleresults, results);\r\n\r\n    this.loading = false;\r\n    this.moreResults = false;\r\n\r\n    m.lazyRedraw();\r\n\r\n    return results;\r\n  }\r\n\r\n  /**\r\n   * Remove a google search from the list if it is present.\r\n   *\r\n   * @param {Array} list\r\n   * @public\r\n   */\r\n  removeList(list) {\r\n    const index = this.googleresults.indexOf(list);\r\n\r\n    if (index !== -1) {\r\n      this.googleresults.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add a google search to the top of the list.\r\n   *\r\n   * @param {Array} list\r\n   * @public\r\n   */\r\n  addList(list) {\r\n    this.googleresults.unshift(list);\r\n  }\r\n}\r\n","import { extend } from \"flarum/extend\";\r\nimport app from \"flarum/app\";\r\nimport Page from \"flarum/components/Page\";\r\nimport ItemList from \"flarum/utils/ItemList\";\r\nimport listItems from \"flarum/helpers/listItems\";\r\nimport IndexPage from \"flarum/components/IndexPage\";\r\nimport Alert from \"flarum/components/Alert\";\r\nimport Button from \"flarum/components/Button\";\r\nimport LinkButton from \"flarum/components/LinkButton\";\r\nimport SelectDropdown from \"flarum/components/SelectDropdown\";\r\nimport GoogleSearchList from \"./GoogleSearchList\";\r\n\r\n/**\r\n * The `IndexPage` component displays the index page, including the welcome\r\n * hero, the sidebar, and the discussion list.\r\n */\r\nexport default class GoogleSearchPage extends Page {\r\n  init() {\r\n    super.init();\r\n\r\n    const params = this.params();\r\n    this.bodyClass = \"App--index\";\r\n\r\n    // If the user is coming from the discussion list, then they have either\r\n    // just switched one of the parameters (filter, sort, search) or they\r\n    // probably want to refresh the results. We will clear the discussion list\r\n    // cache so that results are reloaded.\r\n    if (app.previous instanceof GoogleSearchPage) {\r\n      app.cache.googleSearchList = null;\r\n    }\r\n\r\n    if (app.cache.googleSearchList) {\r\n      // Compare the requested parameters (sort, search query) to the ones that\r\n      // are currently present in the cached discussion list. If they differ, we\r\n      // will clear the cache and set up a new discussion list component with\r\n      // the new parameters.\r\n      Object.keys(params).some(key => {\r\n        if (app.cache.googleSearchList.props.params[key] !== params[key]) {\r\n          app.cache.googleSearchList = null;\r\n          return true;\r\n        }\r\n      });\r\n    }\r\n\r\n    if (!app.cache.googleSearchList) {\r\n      app.cache.googleSearchList = new GoogleSearchList({ params });\r\n    }\r\n    if (!app.session.user) {\r\n      this.alertNotice();\r\n    }\r\n  }\r\n\r\n  onunload() {\r\n    // Save the scroll position so we can restore it when we return to the\r\n    // result list.\r\n    app.cache.scrollTop = $(window).scrollTop();\r\n  }\r\n\r\n  view() {\r\n    return (\r\n      <div className=\"IndexPage\">\r\n        {IndexPage.prototype.hero()}\r\n        <div className=\"container\">\r\n          <div className=\"sideNavContainer\">\r\n            <nav className=\"IndexPage-nav sideNav\">\r\n              <ul>{listItems(this.sidebarItems().toArray())}</ul>\r\n            </nav>\r\n            <div className=\"IndexPage-results sideNavOffset\">\r\n              <div className=\"IndexPage-toolbar\">\r\n                <ul className=\"IndexPage-toolbar-view\"></ul>\r\n                <ul className=\"IndexPage-toolbar-action\">\r\n                  {listItems(this.actionItems().toArray())}\r\n                </ul>\r\n              </div>\r\n              {app.cache.googleSearchList.render()}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  config(isInitialized, context) {\r\n    super.config(...arguments);\r\n\r\n    if (isInitialized) return;\r\n\r\n    extend(context, \"onunload\", () => $(\"#app\").css(\"min-height\", \"\"));\r\n\r\n    app.setTitle(\"\");\r\n    app.setTitleCount(0);\r\n\r\n    // Work out the difference between the height of this hero and that of the\r\n    // previous hero. Maintain the same scroll position relative to the bottom\r\n    // of the hero so that the sidebar doesn't jump around.\r\n    const oldHeroHeight = app.cache.heroHeight;\r\n    const heroHeight = (app.cache.heroHeight =\r\n      this.$(\".Hero\").outerHeight() || 0);\r\n    const scrollTop = app.cache.scrollTop;\r\n\r\n    $(\"#app\").css(\"min-height\", $(window).height() + heroHeight);\r\n\r\n    // Scroll to the remembered position. We do this after a short delay so that\r\n    // it happens after the browser has done its own \"back button\" scrolling,\r\n    // which isn't right. https://github.com/flarum/core/issues/835\r\n    const scroll = () =>\r\n      $(window).scrollTop(scrollTop - oldHeroHeight + heroHeight);\r\n    scroll();\r\n    setTimeout(scroll, 1);\r\n  }\r\n\r\n  alertNotice() {\r\n    let alert;\r\n    app.alerts.show(\r\n      (alert = new Alert({\r\n        type: \"error\",\r\n        children: app.translator.trans(\r\n          \"irony-google-search.forum.page.notice_text\"\r\n        )\r\n      }))\r\n    );\r\n    // 5秒后自动关闭\r\n    setTimeout(function() {\r\n      app.alerts.dismiss(alert);\r\n    }, 3000);\r\n  }\r\n\r\n  /**\r\n   * Build an item list for the sidebar of the index page. By default this is a\r\n   * \"New Discussion\" button, and then a DropdownSelect component containing a\r\n   * list of navigation items.\r\n   *\r\n   * @return {ItemList}\r\n   */\r\n  sidebarItems() {\r\n    const items = IndexPage.prototype.sidebarItems();\r\n\r\n    items.replace(\r\n      \"nav\",\r\n      SelectDropdown.component({\r\n        children: this.navItems(this).toArray(),\r\n        buttonClassName: \"Button\",\r\n        className: \"App-titleControl\"\r\n      })\r\n    );\r\n\r\n    return items;\r\n  }\r\n\r\n  /**\r\n   * Build an item list for the navigation in the sidebar of the index page. By\r\n   * default this is just the 'All Discussions' link.\r\n   *\r\n   * @return {ItemList}\r\n   */\r\n  navItems() {\r\n    const items = IndexPage.prototype.navItems();\r\n    const params = this.stickyParams();\r\n\r\n    items.add(\r\n      \"irony-google-search\",\r\n      LinkButton.component({\r\n        href: app.route(\"irony_google_search\", params),\r\n        children: app.translator.trans(\"irony-google-search.forum.page.nav\"),\r\n        icon: \"fab fa-google\"\r\n      }),\r\n      85\r\n    );\r\n\r\n    return items;\r\n  }\r\n\r\n  /**\r\n   * Build an item list for the part of the toolbar which is about taking action\r\n   * on the results. By default this is just a \"mark all as read\" button.\r\n   *\r\n   * @return {ItemList}\r\n   */\r\n  actionItems() {\r\n    const items = new ItemList();\r\n\r\n    // 刷新按钮\r\n    items.add(\r\n      \"refresh\",\r\n      Button.component({\r\n        title: app.translator.trans(\"core.forum.index.refresh_tooltip\"),\r\n        icon: \"fas fa-sync\",\r\n        className: \"Button Button--icon\",\r\n        onclick: () => {\r\n          if (app.session.user) {\r\n            app.cache.googleSearchList.refresh();\r\n          } else {\r\n            this.alertNotice();\r\n          }\r\n        }\r\n      })\r\n    );\r\n\r\n    return items;\r\n  }\r\n\r\n  /**\r\n   * Return the current search query, if any. This is implemented to activate\r\n   * the search box in the header.\r\n   *\r\n   * @see Search\r\n   * @return {String}\r\n   */\r\n  searching() {\r\n    return this.params();\r\n  }\r\n\r\n  /**\r\n   * Redirect to the index page without a search filter. This is called when the\r\n   * 'x' is clicked in the search box in the header.\r\n   *\r\n   * @see Search\r\n   */\r\n  clearSearch() {\r\n    m.route(app.route(this.props.routeName, {}));\r\n  }\r\n\r\n  /**\r\n   * Get URL parameters that stick between filter changes.\r\n   *\r\n   * @return {Object}\r\n   */\r\n  stickyParams() {\r\n    return m.route.param();\r\n  }\r\n\r\n  /**\r\n   * Get parameters to pass to the GoogleSearchList component.\r\n   *\r\n   * @return {Object}\r\n   */\r\n  params() {\r\n    return m.route.param();\r\n  }\r\n}\r\n","import { extend } from \"flarum/extend\";\r\nimport app from \"flarum/app\";\r\nimport DiscussionsSearchSource from \"flarum/components/DiscussionsSearchSource\";\r\nimport LinkButton from \"flarum/components/LinkButton\";\r\nimport IndexPage from \"flarum/components/IndexPage\";\r\nimport GoogleSearchPage from \"./components/GoogleSearchPage\";\r\n\r\n// Allow other extensions to extend the page\r\nexport { GoogleSearchPage };\r\n\r\napp.initializers.add(\"irony-google-search\", app => {\r\n  // 扩展路由到指定页面\r\n  app.routes.irony_google_search = {\r\n    path: \"/google\",\r\n    component: GoogleSearchPage.component()\r\n  };\r\n\r\n  // 增加搜索框扩展显示\r\n  extend(DiscussionsSearchSource.prototype, \"view\", function(view, query) {\r\n    if (!view) {\r\n      return;\r\n    }\r\n\r\n    query = query.toLowerCase();\r\n\r\n    view.splice(\r\n      100, // 尽量排在最后\r\n      0,\r\n      <li className=\"Dropdown-header\">\r\n        {app.translator.trans(\r\n          \"irony-google-search.forum.search.search_heading\"\r\n        )}\r\n      </li>,\r\n      <li>\r\n        {LinkButton.component({\r\n          icon: \"fas fa-search\",\r\n          children: app.translator.trans(\r\n            \"irony-google-search.forum.search.all_search_button\",\r\n            { query }\r\n          ),\r\n          href: app.route(\"irony_google_search\", { q: query })\r\n        })}\r\n      </li>\r\n    );\r\n  });\r\n\r\n  // 增加左侧导航显示\r\n  extend(IndexPage.prototype, \"navItems\", items => {\r\n    items.add(\r\n      \"irony-google-search\",\r\n      LinkButton.component({\r\n        href: app.route(\"irony_google_search\"),\r\n        children: app.translator.trans(\"irony-google-search.forum.page.nav\"),\r\n        icon: \"fab fa-google\"\r\n      }),\r\n      85\r\n    );\r\n  });\r\n});\r\n","export * from './src/forum';\r\n"],"sourceRoot":""}